
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://vektonn.github.io/vektonn/reference/specification/">
      
      <link rel="icon" href="../../assets/vektonn-star-rounded-white.svg">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Sort of formal specification - Vektonn</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KXSME6LZNH"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-KXSME6LZNH",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KXSME6LZNH"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-points" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Vektonn" class="md-header__button md-logo" aria-label="Vektonn" data-md-component="logo">
      
  <img src="../../assets/vektonn-star-rounded-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vektonn
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Sort of formal specification
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <!-- Copied from https://github.com/squidfunk/mkdocs-material/blob/master/src/partials/source.html -->

<!--
  Copyright (c) 2016-2021 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Repository information -->
<a
  href="https://github.com/vektonn/vektonn"
  title="Go to repository"
  class="md-source"
>
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Vektonn" class="md-nav__button md-logo" aria-label="Vektonn" data-md-component="logo">
      
  <img src="../../assets/vektonn-star-rounded-white.svg" alt="logo">

    </a>
    Vektonn
  </label>
  
    <div class="md-nav__source">
      <!-- Copied from https://github.com/squidfunk/mkdocs-material/blob/master/src/partials/source.html -->

<!--
  Copyright (c) 2016-2021 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Repository information -->
<a
  href="https://github.com/vektonn/vektonn"
  title="Go to repository"
  class="md-source"
>
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        Features
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        API
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Sort of formal specification
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Sort of formal specification
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-points" class="md-nav__link">
    Data points
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-sources" class="md-nav__link">
    Data sources
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indices" class="md-nav__link">
    Indices
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sharding" class="md-nav__link">
    Sharding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splitting" class="md-nav__link">
    Splitting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-data" class="md-nav__link">
    Updating data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#searching" class="md-nav__link">
    Searching
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../supported-algorithms/" class="md-nav__link">
        Supported index algorithms
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>Sort of formal specification</h1>

<h2 id="data-points">Data points<a class="headerlink" href="#data-points" title="Permanent link">&para;</a></h2>
<p><strong>Data point</strong> is a single piece of data to store in Vektonn. 
It contains both vector (dense or sparse) and its attributes. 
You can use <strong>attributes</strong> to store relevant data from your domain.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">DataPoint</span> <span class="o">:=</span> <span class="p">(</span><span class="n">Vector</span><span class="p">,</span> <span class="n">Attributes</span><span class="p">)</span>

<span class="n">Vector</span>       <span class="o">:=</span> <span class="n">DenseVector</span> <span class="o">|</span> <span class="n">SparseVector</span>
<span class="n">DenseVector</span>  <span class="o">:=</span> <span class="p">(</span><span class="n">coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">float64</span><span class="p">])</span>
<span class="n">SparseVector</span> <span class="o">:=</span> <span class="p">(</span><span class="n">coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">float64</span><span class="p">],</span> <span class="n">coordinateIndices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span>

<span class="n">Attribute</span>      <span class="o">:=</span> <span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">AttributeKey</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">AttributeValue</span><span class="p">)</span>
<span class="n">Attributes</span>     <span class="o">:=</span> <span class="nb">dict</span><span class="p">[</span><span class="n">AttributeKey</span><span class="p">,</span> <span class="n">AttributeValue</span><span class="p">]</span>
<span class="n">AttributeKey</span>   <span class="o">:=</span> <span class="nb">str</span>
<span class="n">AttributeValue</span> <span class="o">:=</span> <span class="nb">bool</span> <span class="o">|</span> <span class="n">int64</span> <span class="o">|</span> <span class="n">float64</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">UUID</span> <span class="o">|</span> <span class="n">datetime</span>
</code></pre></div>
</td></tr></table>
<h2 id="data-sources">Data sources<a class="headerlink" href="#data-sources" title="Permanent link">&para;</a></h2>
<p><strong>Data source</strong> is a named (and versioned) persistent storage for data points. 
It represents a timeline of all data points' updates (uploads and deletions).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">DataSourceId</span> <span class="o">:=</span> <span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span>

<span class="n">DataSourceMeta</span> <span class="o">:=</span> <span class="p">(</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">DataSourceId</span><span class="p">,</span>

    <span class="n">vectorDimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">vectorsAreSparse</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>

    <span class="n">permanentAttributes</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">AttributeKey</span><span class="p">],</span>
    <span class="n">attributeValueTypes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">AttributeKey</span><span class="p">,</span> <span class="n">AttributeValueType</span><span class="p">]</span> <span class="c1"># defines a type of AttributeValue for each AttributeKey</span>
<span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Defining a data source requires you to set the type of data points that it will store, including their vector dimension and permanent attributes.</p>
<p><strong>Permanent attributes</strong> are attributes that all data points must have. 
Neither the set of keys nor the values of <code>permanentAttributes</code> can change for a given data point over time.</p>
<p>You cannot query a data source directly — you have to create an <a href="#indices">index</a> for that.</p>
<h2 id="indices">Indices<a class="headerlink" href="#indices" title="Permanent link">&para;</a></h2>
<p><strong>Index</strong> is a snapshot of a single data source that allows to query for data points. 
Indices are asynchronously updated, making them <a href="https://en.wikipedia.org/wiki/Eventual_consistency">eventually consistent</a> with their data sources.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">IndexAlgorithm</span> <span class="o">:=</span> <span class="p">(</span><span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span>  <span class="c1"># (1)</span>

<span class="n">IndexMeta</span> <span class="o">:=</span> <span class="p">(</span>
    <span class="nb">id</span><span class="p">:</span>                <span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">),</span>

    <span class="n">dataSource</span><span class="p">:</span>        <span class="n">DataSourceId</span><span class="p">,</span>
    <span class="n">indexAlgorithm</span><span class="p">:</span>    <span class="n">IndexAlgorithm</span><span class="p">,</span>

    <span class="n">idAttributes</span><span class="p">:</span>      <span class="nb">set</span><span class="p">[</span><span class="n">AttributeKey</span><span class="p">],</span>
    <span class="n">splitAttributes</span><span class="p">:</span>   <span class="nb">set</span><span class="p">[</span><span class="n">AttributeKey</span><span class="p">],</span>
    <span class="n">shardAttributes</span><span class="p">:</span>   <span class="nb">set</span><span class="p">[</span><span class="n">AttributeKey</span><span class="p">],</span>
    <span class="n">payloadAttributes</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">AttributeKey</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">Index</span><span class="o">.</span><span class="n">idAttributes</span> <span class="err">≠</span> <span class="err">∅</span>

<span class="n">Index</span><span class="o">.</span><span class="n">permanentAttributes</span> <span class="o">:=</span> <span class="n">Index</span><span class="o">.</span><span class="n">idAttributes</span> <span class="err">⋃</span> <span class="n">Index</span><span class="o">.</span><span class="n">splitAttributes</span> <span class="err">⋃</span> <span class="n">Index</span><span class="o">.</span><span class="n">shardAttributes</span>
<span class="n">Index</span><span class="o">.</span><span class="n">permanentAttributes</span> <span class="err">⊆</span> <span class="n">DataSourceMeta</span><span class="o">.</span><span class="n">permanentAttributes</span>
<span class="n">Index</span><span class="o">.</span><span class="n">permanentAttributes</span> <span class="err">⋂</span> <span class="n">Index</span><span class="o">.</span><span class="n">payloadAttributes</span> <span class="err">≡</span> <span class="err">∅</span>
</code></pre></div>
</td></tr></table>
<ol>
<li>See the list of <a href="/vektonn/reference/supported-algorithms">supported algorithms</a>.</li>
</ol>
<p><a name="permanent-attributes"></a>
Index's <strong>permanent attributes</strong> are:</p>
<ul>
<li><code>idAttributes</code> — a set of keys from your domain that uniquely identifies an object represented by the vector;</li>
<li><code>shardAttributes</code> — defines a <a href="#sharding">sharding</a> scheme;</li>
<li><code>splitAttributes</code> — defines a <a href="#splitting">splitting</a> scheme.</li>
</ul>
<p>Note that <code>idAttributes</code>, <code>splitAttributes</code>, and <code>shardAttributes</code> sets can be in arbitrary relationships, but each one must be a subset of a corresponding data source's permanent attributes. 
They cannot be changed during vector's lifetime.</p>
<p>All <strong>other attributes</strong> are <code>payloadAttributes</code> — any metadata to be stored alongside the vector that may be freely updated.</p>
<h2 id="sharding">Sharding<a class="headerlink" href="#sharding" title="Permanent link">&para;</a></h2>
<p><strong>Shards</strong> are a physical representation of an index. 
Each shard has a subset of index's data according to defined sharding scheme. 
It's possible to have a single shard for an index: that way everything is located on a single machine. 
Multiple shards, however, are useful to distribute data across several nodes to fit into RAM limitations.</p>
<h2 id="splitting">Splitting<a class="headerlink" href="#splitting" title="Permanent link">&para;</a></h2>
<p><strong>Splitting</strong> is an optional scheme of dividing shard's data within a <em>single</em> physical node. 
Splits are useful to speed up search: it uses data only from requested splits, everything else is ignored. 
Your domain's data may be naturally divided: for example, when you always perform queries using the data within geographical regions.</p>
<p>To make use of index's splitting, you have to provide values for <em>every</em> corresponding attribute from a splitting scheme on each search upon that index. 
Otherwise, the search will be conducted on all partially matched splits and merged afterwards.</p>
<p>You may have several indices running upon the same data source — with different splitting schemes (including no splitting at all).</p>
<h2 id="updating-data">Updating data<a class="headerlink" href="#updating-data" title="Permanent link">&para;</a></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">Upload</span> <span class="o">:=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">UploadQuery</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>

<span class="n">UploadQuery</span>     <span class="o">:=</span> <span class="nb">list</span><span class="p">[</span><span class="n">InputDataPoint</span><span class="p">]</span>
<span class="n">InputDataPoint</span>  <span class="o">:=</span> <span class="n">DataPoint</span> <span class="o">|</span> <span class="n">Tombstone</span>
<span class="n">Tombstone</span>       <span class="o">:=</span> <span class="p">(</span><span class="n">permanentAttributes</span><span class="p">:</span> <span class="n">Attributes</span><span class="p">)</span>  <span class="c1"># uniquely identify a data point to delete</span>
</code></pre></div>
</td></tr></table>
<p>Data updates are one of either:</p>
<ul>
<li>an <strong>upload</strong> of a new data point;</li>
<li>an <strong>update</strong> of existing data point identified by its permanent attributes;</li>
<li>a <strong>deletion</strong> of a previously uploaded data point, marked by a <code>tombstone</code>.</li>
</ul>
<h2 id="searching">Searching<a class="headerlink" href="#searching" title="Permanent link">&para;</a></h2>
<p>Search for <code>k</code> nearest neighbors for each of <code>queryVectors</code>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">Search</span> <span class="o">:=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">SearchQuery</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="n">SearchResult</span><span class="p">]]</span>

<span class="n">SearchQuery</span>    <span class="o">:=</span> <span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">queryVectors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Vector</span><span class="p">],</span> <span class="n">splitFilter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Attributes</span><span class="p">])</span>

<span class="n">SearchResult</span>   <span class="o">:=</span> <span class="p">(</span><span class="n">queryVector</span><span class="p">:</span> <span class="n">Vector</span><span class="p">,</span> <span class="n">nearestDataPoints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FoundDataPoint</span><span class="p">])</span>
<span class="n">FoundDataPoint</span> <span class="o">:=</span> <span class="p">(</span><span class="n">dataPoint</span><span class="p">:</span> <span class="n">DataPoint</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="n">float64</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>If <code>SearchQuery.splitFilter</code> is present then <code>SearchQuery.splitFilter.keys ⊆ IndexMeta.splitAttributes</code>.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../api/" class="md-footer__link md-footer__link--prev" aria-label="Previous: API" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              API
            </div>
          </div>
        </a>
      
      
        
        <a href="../supported-algorithms/" class="md-footer__link md-footer__link--next" aria-label="Next: Supported index algorithms" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Supported index algorithms
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate", "content.code.annotate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>